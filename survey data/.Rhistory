)
# p1: Encounter Frequency plot
p1 <- ggplot(df1, aes(x = percentage, y = review, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Frequency") +
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(y = NULL, x = NULL, title = "Vulnerability Encounter Frequency per Review Type") +
theme_minimal() +
theme(
legend.position = "none",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust = -0.155, size = 26),
axis.title.y = element_text(size = axis_text),
#axis.text.x = element_text(angle = 45, hjust = 1, size = label_text),
axis.text.y = element_text(size = label_text-4)
)
# p2: Review Frequency plot
p2 <- ggplot(df2, aes(x = percentage, y = review, fill = conduct)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Frequency") +
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(y = NULL, x = NULL, title = "Review Frequency per Review Type") +
theme_minimal() +
theme(
legend.position = "none",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust = -0.118, size = 26),
axis.title.y = element_text(size = axis_text),
#axis.text.x = element_text(angle = 45, hjust = 1, size = label_text),
axis.text.y = element_text(size = label_text-4)
)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(y = NULL, x = "Percentage of Participants", title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)") +
theme_minimal() +
theme(
legend.position = "bottom",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size-2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text-4),
axis.title.y = element_text(size = axis_text),
#axis.text.x = element_text(angle = 45, hjust = 1, size = label_text),
axis.text.x = element_text(size = label_text-4),
axis.text.y = element_text(size = label_text-4)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review\nFrequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
View(p3)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
#label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
legend.title.align = 0.5,
#label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
legend.title.align = 5,
#label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
#label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,  # <- Center the legend title
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",   # Title above the legend row
#label.position = "bottom",# Puts label below color boxes (optional)
nrow = 1,                 # All items on one row
title.hjust = 0           # Left-align the title
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,  # <- Center the legend title
plot.title = element_text(hjust = -0.135, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",    # <- Title above items
label.position = "right",  # <- Standard layout
nrow = 1,
byrow = TRUE
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,  # <- Center the legend title
plot.title = element_text(hjust = -0.145, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",    # <- Title above items
label.position = "right",  # <- Standard layout
nrow = 1,
byrow = TRUE
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Review Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,  # <- Center the legend title
plot.title = element_text(hjust = -0.185, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",    # <- Title above items
label.position = "right",  # <- Standard layout
nrow = 1,
byrow = TRUE
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
library(ggplot2)
library(patchwork)
your_palette = c(
"Fewer" = "#d73027",
"Once a month" = "#fc8d59",
"Mutliple times a month" = "#fee090",
"Multiple times a month" = "#fee090",
"Once a week" = "#91bfdb",
"Multiple times a week" = "#4575b4"
)
# p1: Encounter Frequency plot
p1 <- ggplot(df1, aes(x = percentage, y = review, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Frequency") +
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(y = NULL, x = NULL, title = "Vulnerability Encounter Frequency per Review Type") +
theme_minimal() +
theme(
legend.position = "none",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust = -0.155, size = 26),
axis.title.y = element_text(size = axis_text),
#axis.text.x = element_text(angle = 45, hjust = 1, size = label_text),
axis.text.y = element_text(size = label_text-4)
)
# p2: Review Frequency plot
p2 <- ggplot(df2, aes(x = percentage, y = review, fill = conduct)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Frequency") +
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(y = NULL, x = NULL, title = "Review Frequency per Review Type") +
theme_minimal() +
theme(
legend.position = "none",
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust = -0.118, size = 26),
axis.title.y = element_text(size = axis_text),
#axis.text.x = element_text(angle = 45, hjust = 1, size = label_text),
axis.text.y = element_text(size = label_text-4)
)
# p3: Tool Helpfulness plot
p3 <- ggplot(df3, aes(x = percentage, y = performance, fill = frequently)) +
geom_bar(stat = "identity", position = "stack", width = 0.95, alpha = 0.55) +
geom_text(aes(label = ifelse(n > 0, n, "")), position = position_stack(vjust = 0.5), size = 6) +
scale_fill_manual(values = your_palette, name = "Frequency") +  # Manual line break if needed
scale_x_continuous(labels = function(x) paste0(x, "%"), limits = c(0, 100)) +
labs(
y = NULL,
x = "Percentage of Participants",
title = "Review Frequency per Helpfulness Level (1 = Low, 5 = High)"
) +
theme_minimal() +
theme(
legend.position = "bottom",
legend.box = "horizontal",
legend.title.align = 0.5,  # <- Center the legend title
plot.title = element_text(hjust = -0.185, size = 26),
legend.text = element_text(size = legend_size - 2),
legend.title = element_text(size = legend_size),
axis.title.x = element_text(size = axis_text - 4),
axis.title.y = element_text(size = axis_text),
axis.text.x = element_text(size = label_text - 4),
axis.text.y = element_text(size = label_text - 4)
) +
guides(
fill = guide_legend(
title.position = "top",    # <- Title above items
label.position = "right",  # <- Standard layout
nrow = 1,
byrow = TRUE
)
)
# Combine using patchwork
combined_plot <- p2 / p1 / p3 + plot_layout(heights = c(1, 1, 1.6))
# Print
combined_plot
ggsave("all_together.pdf", width = width-2, height = height, dpi = dpi)
